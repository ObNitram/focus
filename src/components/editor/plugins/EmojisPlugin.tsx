import { $createEmojiNode } from "../nodes/EmojiNode";
import { useEffect } from "react";
import { TextNode } from "lexical";
import { useLexicalComposerContext } from "@lexical/react/LexicalComposerContext";

import styles from "../../../assets/styles/editor.module.scss";

const emojis = {
  ":grinning:": "ðŸ˜€",
    ":smiley:": "ðŸ˜ƒ",
    ":smile:": "ðŸ˜„",
    ":grin:": "ðŸ˜",
    ":laughing:": "ðŸ˜†",
    ":satisfied:": "ðŸ˜†",
    ":sweat_smile:": "ðŸ˜…",
    ":rofl:": "ðŸ¤£",
    ":joy:": "ðŸ˜‚",
    ":slightly_smiling_face:": "ðŸ™‚",
    ":upside_down_face:": "ðŸ™ƒ",
    ":wink:": "ðŸ˜‰",
    ":blush:": "ðŸ˜Š",
    ":innocent:": "ðŸ˜‡",
    ":smiling_face_with_three_hearts:": "ðŸ¥°",
    ":heart_eyes:": "ðŸ˜",
    ":star_struck:": "ðŸ¤©",
    ":kissing_heart:": "ðŸ˜˜",
    ":kissing:": "ðŸ˜—",
    ":kissing_closed_eyes:": "ðŸ˜š",
    ":kissing_smiling_eyes:": "ðŸ˜™",
    ":smiling_face_with_tear:": "ðŸ¥²",
    ":yum:": "ðŸ˜‹",
    ":stuck_out_tongue:": "ðŸ˜›",
    ":stuck_out_tongue_winking_eye:": "ðŸ˜œ",
    ":zany_face:": "ðŸ¤ª",
    ":stuck_out_tongue_closed_eyes:": "ðŸ˜",
    ":money_mouth_face:": "ðŸ¤‘",
    ":hugs:": "ðŸ¤—",
    ":hand_over_mouth:": "ðŸ¤­",
    ":shushing_face:": "ðŸ¤«",
    ":thinking:": "ðŸ¤”",
    ":zipper_mouth_face:": "ðŸ¤",
    ":raised_eyebrow:": "ðŸ¤¨",
    ":neutral_face:": "ðŸ˜",
    ":expressionless:": "ðŸ˜‘",
    ":no_mouth:": "ðŸ˜¶",
    ":smirk:": "ðŸ˜",
    ":unamused:": "ðŸ˜’",
    ":roll_eyes:": "ðŸ™„",
    ":grimacing:": "ðŸ˜¬",
    ":face_exhaling:": "ðŸ˜®â€ðŸ’¨",
    ":lying_face:": "ðŸ¤¥",
    ":relieved:": "ðŸ˜Œ",
    ":pensive:": "ðŸ˜”",
    ":sleepy:": "ðŸ˜ª",
    ":drooling_face:": "ðŸ¤¤",
    ":sleeping:": "ðŸ˜´",
    ":mask:": "ðŸ˜·",
    ":face_with_thermometer:": "ðŸ¤’",
    ":face_with_head_bandage:": "ðŸ¤•",
    ":nauseated_face:": "ðŸ¤¢",
    ":vomiting_face:": "ðŸ¤®",
    ":sneezing_face:": "ðŸ¤§",
    ":hot_face:": "ðŸ¥µ",
    ":cold_face:": "ðŸ¥¶",
    ":woozy_face:": "ðŸ¥´",
    ":dizzy_face:": "ðŸ˜µ",
    ":exploding_head:": "ðŸ¤¯",
    ":cowboy_hat_face:": "ðŸ¤ ",
    ":partying_face:": "ðŸ¥³",
    ":disguised_face:": "ðŸ¥¸",
    ":sunglasses:": "ðŸ˜Ž",
    ":nerd_face:": "ðŸ¤“",
    ":monocle_face:": "ðŸ§",
    ":confused:": "ðŸ˜•",
    ":worried:": "ðŸ˜Ÿ",
    ":slightly_frowning_face:": "ðŸ™",
    ":frowning_face:": "â˜¹ï¸",
    ":open_mouth:": "ðŸ˜®",
    ":hushed:": "ðŸ˜¯",
    ":astonished:": "ðŸ˜²",
    ":flushed:": "ðŸ˜³",
    ":pleading_face:": "ðŸ¥º",
    ":frowning:": "ðŸ˜¦",
    ":anguished:": "ðŸ˜§",
    ":fearful:": "ðŸ˜¨",
    ":cold_sweat:": "ðŸ˜°",
    ":disappointed_relieved:": "ðŸ˜¥",
    ":cry:": "ðŸ˜¢",
    ":sob:": "ðŸ˜­",
    ":scream:": "ðŸ˜±",
    ":confounded:": "ðŸ˜–",
    ":persevere:": "ðŸ˜£",
    ":disappointed:": "ðŸ˜ž",
    ":sweat:": "ðŸ˜“",
    ":weary:": "ðŸ˜©",
    ":tired_face:": "ðŸ˜«",
    ":yawning_face:": "ðŸ¥±",
    ":triumph:": "ðŸ˜¤",
    ":pout:": "ðŸ˜¡",
    ":rage:": "ðŸ˜ ",
    ":angry:": "ðŸ˜ ",
    ":cursing_face:": "ðŸ¤¬",
    ":smiling_imp:": "ðŸ˜ˆ",
    ":imp:": "ðŸ‘¿",
    ":skull:": "ðŸ’€",
    ":skull_and_crossbones:": "â˜ ï¸",
    ":hankey:": "ðŸ’©",
    ":poop:": "ðŸ’©",
    ":shit:": "ðŸ’©",
    ":clown_face:": "ðŸ¤¡",
    ":japanese_ogre:": "ðŸ‘¹",
    ":japanese_goblin:": "ðŸ‘º",
    ":ghost:": "ðŸ‘»",
    ":alien:": "ðŸ‘½",
    ":space_invader:": "ðŸ‘¾",
    ":robot:": "ðŸ¤–",
    ":smiley_cat:": "ðŸ˜º",
    ":smile_cat:": "ðŸ˜¸",
    ":joy_cat:": "ðŸ˜¹",
    ":heart_eyes_cat:": "ðŸ˜»",
    ":smirk_cat:": "ðŸ˜¼",
    ":kissing_cat:": "ðŸ˜½",
    ":scream_cat:": "ðŸ™€",
    ":crying_cat_face:": "ðŸ˜¿",
    ":pouting_cat:": "ðŸ˜¾",
    ":see_no_evil:": "ðŸ™ˆ",
    ":hear_no_evil:": "ðŸ™‰",
    ":speak_no_evil:": "ðŸ™Š",
    ":kiss:": "ðŸ’‹",
    ":love_letter:": "ðŸ’Œ",
    ":cupid:": "ðŸ’˜",
    ":gift_heart:": "ðŸ’",
    ":sparkling_heart:": "ðŸ’–",
    ":heartpulse:": "ðŸ’—",
    ":heartbeat:": "ðŸ’“",
    ":revolving_hearts:": "ðŸ’ž",
    ":two_hearts:": "ðŸ’•",
    ":heart_decoration:": "ðŸ’Ÿ",
    ":heavy_heart_exclamation:": "â£ï¸",
    ":broken_heart:": "ðŸ’”",
    ":heart:": "â¤ï¸",
    ":orange_heart:": "ðŸ§¡",
    ":yellow_heart:": "ðŸ’›",
    ":green_heart:": "ðŸ’š",
    ":blue_heart:": "ðŸ’™",
    ":purple_heart:": "ðŸ’œ",
    ":brown_heart:": "ðŸ¤Ž",
    ":black_heart:": "ðŸ–¤",
    ":white_heart:": "ðŸ¤",
    ":100:": "ðŸ’¯",
    ":anger:": "ðŸ’¢",
    ":boom:": "ðŸ’¥",
    ":collision:": "ðŸ’¥",
    ":dizzy:": "ðŸ’«",
    ":sweat_drops:": "ðŸ’¦",
    ":dash:": "ðŸ’¨",
    ":hole:": "ðŸ•³ï¸",
    ":bomb:": "ðŸ’£",
    ":speech_balloon:": "ðŸ’¬",
    ":eye_speech_bubble:": "ðŸ‘ï¸â€ðŸ—¨ï¸",
    ":left_speech_bubble:": "ðŸ—¨ï¸",
    ":right_anger_bubble:": "ðŸ—¯ï¸",
    ":thought_balloon:": "ðŸ’­",
    ":zzz:": "ðŸ’¤",
    ":wave:": "ðŸ‘‹",
    ":raised_back_of_hand:": "ðŸ¤š",
    ":raised_hand_with_fingers_splayed:": "ðŸ–ï¸",
    ":hand:": "âœ‹",
    ":raised_hand:": "âœ‹",
    ":vulcan_salute:": "ðŸ––",
    ":ok_hand:": "ðŸ‘Œ",
    ":pinched_fingers:": "ðŸ¤Œ",
    ":pinching_hand:": "ðŸ¤",
    ":v:": "âœŒï¸",
    ":crossed_fingers:": "ðŸ¤ž",
    ":love_you_gesture:": "ðŸ¤Ÿ",
    ":metal:": "ðŸ¤˜",
    ":call_me_hand:": "ðŸ¤™",
    ":point_left:": "ðŸ‘ˆ",
    ":point_right:": "ðŸ‘‰",
    ":point_up_2:": "ðŸ‘†",
    ":fu:": "ðŸ–•",
    ":middle_finger:": "ðŸ–•",
    ":point_down:": "ðŸ‘‡",
    ":point_up:": "â˜ï¸",
    ":thumbsup:": "ðŸ‘",
    ":thumbsdown:": "ðŸ‘Ž",
    ":fist:": "âœŠ",
    ":fist_raised:": "âœŠ",
    ":facepunch:": "ðŸ‘Š",
    ":fist_oncoming:": "ðŸ‘Š",
    ":punch:": "ðŸ‘Š",
    ":fist_left:": "ðŸ¤›",
    ":fist_right:": "ðŸ¤œ",
    ":clap:": "ðŸ‘",
    ":raised_hands:": "ðŸ™Œ",
    ":open_hands:": "ðŸ‘",
    ":palms_up_together:": "ðŸ¤²",
    ":handshake:": "ðŸ¤",
    ":pray:": "ðŸ™",
    ":writing_hand:": "âœï¸",
    ":nail_care:": "ðŸ’…",
    ":selfie:": "ðŸ¤³",
    ":muscle:": "ðŸ’ª",
};

function emoticonTransform(node) {
  const textContent = node.getTextContent();

  textContent.replace(/:[a-z_]+:/g, (word) => {
    if (word in emojis) {

      const offset = textContent.indexOf(word);
      const length = word.length;

      const textsNodes: TextNode[] = node.splitText(offset, offset + length);

      textsNodes.find((textNode) => {
        if (textNode.getTextContent() === word) {
          textNode.replace($createEmojiNode("emoji", emojis[word]));
        }
      });
    }
  });
}

function useEmojis(editor) {
  useEffect(() => {
    const removeTransform = editor.registerNodeTransform(
      TextNode,
      emoticonTransform,
    );

    return () => {
      removeTransform();
    };
  }, [editor]);
}

export default function EmojisPlugin() {
  const [editor] = useLexicalComposerContext();
  useEmojis(editor);
  return null;
}
